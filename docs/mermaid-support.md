# Mermaid å›¾è¡¨æ”¯æŒæ–‡æ¡£

## æ¦‚è¿°

agent-chat-ui ç°å·²æ”¯æŒ Mermaid å›¾è¡¨æ¸²æŸ“ï¼Œå¯ä»¥åœ¨ Markdown å†…å®¹ä¸­åµŒå…¥æµç¨‹å›¾ã€åºåˆ—å›¾ã€ç”˜ç‰¹å›¾ç­‰å¤šç§å¯è§†åŒ–å›¾è¡¨ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… è‡ªåŠ¨è¯†åˆ« Markdown ä¸­çš„ `mermaid` ä»£ç å—
- âœ… æ”¯æŒå¤šç§å›¾è¡¨ç±»å‹ï¼ˆæµç¨‹å›¾ã€åºåˆ—å›¾ã€ç”˜ç‰¹å›¾ã€é¥¼å›¾ã€ç±»å›¾ç­‰ï¼‰
- âœ… é”™è¯¯å¤„ç†å’Œå‹å¥½çš„é”™è¯¯æç¤º
- âœ… å“åº”å¼è®¾è®¡ï¼Œè‡ªé€‚åº”å®¹å™¨å®½åº¦
- âœ… ä¸ç°æœ‰ Markdown æ¸²æŸ“æ— ç¼é›†æˆ
- âœ… **é€æ˜èƒŒæ™¯**ï¼Œè‡ªåŠ¨é€‚åº”é¡µé¢é¢œè‰²
- âœ… **æºä»£ç æŸ¥çœ‹**ï¼Œæ¯ä¸ªå›¾è¡¨éƒ½æœ‰æŠ˜å æŒ‰é’®å¯ä»¥å±•å¼€æŸ¥çœ‹æºä»£ç 

## ä½¿ç”¨æ–¹æ³•

### åœ¨ Markdown ä¸­ä½¿ç”¨

åœ¨ Markdown å†…å®¹ä¸­ä½¿ç”¨ \`\`\`mermaid ä»£ç å—ï¼š

````markdown
```mermaid
graph TD
    A[å¼€å§‹] --> B{åˆ¤æ–­æ¡ä»¶}
    B -->|æ˜¯| C[æ‰§è¡Œä»»åŠ¡A]
    B -->|å¦| D[æ‰§è¡Œä»»åŠ¡B]
    C --> E[ç»“æŸ]
    D --> E
```
````

### ä½œä¸ºç‹¬ç«‹ç»„ä»¶ä½¿ç”¨

```tsx
import { MermaidDiagram } from "@/components/thread/mermaid-diagram";

function MyComponent() {
  const chart = `
    graph LR
      A[è¾“å…¥] --> B[å¤„ç†]
      B --> C[è¾“å‡º]
  `;

  return <MermaidDiagram chart={chart} />;
}
```

## æ”¯æŒçš„å›¾è¡¨ç±»å‹

### 1. æµç¨‹å›¾ (Flowchart)

```mermaid
graph TD
    A[å¼€å§‹] --> B{æ˜¯å¦éœ€è¦æ£€ç´¢?}
    B -->|æ˜¯| C[æ‰§è¡ŒRAGæ£€ç´¢]
    B -->|å¦| D[ç›´æ¥å›ç­”]
    C --> E[ç”Ÿæˆç­”æ¡ˆ]
    D --> E
    E --> F[ç»“æŸ]
```

### 2. åºåˆ—å›¾ (Sequence Diagram)

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as AIåŠ©æ‰‹
    participant R as RAGç³»ç»Ÿ

    U->>A: æå‡ºé—®é¢˜
    A->>R: è§¦å‘æ£€ç´¢
    R-->>A: è¿”å›ä¸Šä¸‹æ–‡
    A->>A: ç”Ÿæˆç­”æ¡ˆ
    A-->>U: è¿”å›ç­”æ¡ˆ
```

### 3. ç”˜ç‰¹å›¾ (Gantt Chart)

```mermaid
gantt
    title é¡¹ç›®å¼€å‘è¿›åº¦
    dateFormat YYYY-MM-DD
    section è®¾è®¡é˜¶æ®µ
    éœ€æ±‚åˆ†æ      :2024-01-01, 7d
    UIè®¾è®¡        :2024-01-08, 5d
    section å¼€å‘é˜¶æ®µ
    å‰ç«¯å¼€å‘      :2024-01-13, 14d
    åç«¯å¼€å‘      :2024-01-13, 14d
```

### 4. é¥¼å›¾ (Pie Chart)

```mermaid
pie title æŠ€æœ¯æ ˆå æ¯”
    "React" : 35
    "TypeScript" : 25
    "Python" : 20
    "Docker" : 15
    "å…¶ä»–" : 5
```

### 5. ç±»å›¾ (Class Diagram)

```mermaid
classDiagram
    class Agent {
        +String name
        +List tools
        +execute()
        +think()
    }
    class RAGAgent {
        +VectorStore vectorStore
        +retrieve()
        +answer()
    }
    Agent <|-- RAGAgent
```

### 6. çŠ¶æ€å›¾ (State Diagram)

```mermaid
stateDiagram-v2
    [*] --> å¾…å¤„ç†
    å¾…å¤„ç† --> è¿›è¡Œä¸­: å¼€å§‹
    è¿›è¡Œä¸­ --> å·²å®Œæˆ: å®Œæˆ
    è¿›è¡Œä¸­ --> å·²å–æ¶ˆ: å–æ¶ˆ
    å·²å®Œæˆ --> [*]
    å·²å–æ¶ˆ --> [*]
```

### 7. ERå›¾ (Entity Relationship)

```mermaid
erDiagram
    USER ||--o{ ORDER : places
    ORDER ||--|{ ORDER_ITEM : contains
    PRODUCT ||--o{ ORDER_ITEM : "ordered in"
```

## åœ¨ AI åŠ©æ‰‹ä¸­çš„åº”ç”¨åœºæ™¯

### 1. è§£é‡Šä¸šåŠ¡æµç¨‹

å½“ç”¨æˆ·è¯¢é—®"ç³»ç»Ÿæ˜¯å¦‚ä½•å¤„ç†è®¢å•çš„ï¼Ÿ"æ—¶ï¼ŒAI å¯ä»¥è¿”å›ï¼š

````markdown
è®¢å•å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š

```mermaid
graph TD
    A[ç”¨æˆ·ä¸‹å•] --> B[éªŒè¯åº“å­˜]
    B -->|åº“å­˜å……è¶³| C[åˆ›å»ºè®¢å•]
    B -->|åº“å­˜ä¸è¶³| D[é€šçŸ¥ç”¨æˆ·]
    C --> E[æ”¯ä»˜å¤„ç†]
    E -->|æˆåŠŸ| F[å‘è´§]
    E -->|å¤±è´¥| G[å–æ¶ˆè®¢å•]
```

è¿™ä¸ªæµç¨‹ç¡®ä¿äº†è®¢å•çš„å®Œæ•´æ€§å’Œå¯é æ€§ã€‚
````

### 2. å±•ç¤ºç³»ç»Ÿæ¶æ„

```mermaid
graph LR
    A[å‰ç«¯] --> B[APIç½‘å…³]
    B --> C[LangGraphä»£ç†]
    C --> D[RAGç³»ç»Ÿ]
    C --> E[å·¥å…·è°ƒç”¨]
    D --> F[å‘é‡æ•°æ®åº“]
    E --> G[å¤–éƒ¨API]
```

### 3. è¯´æ˜äº¤äº’æ—¶åº

```mermaid
sequenceDiagram
    ç”¨æˆ·->>ç³»ç»Ÿ: å‘é€æŸ¥è¯¢
    ç³»ç»Ÿ->>LLM: åˆ†ææ„å›¾
    LLM->>ç³»ç»Ÿ: è¿”å›æ„å›¾
    ç³»ç»Ÿ->>å·¥å…·: è°ƒç”¨ç›¸åº”å·¥å…·
    å·¥å…·->>ç³»ç»Ÿ: è¿”å›ç»“æœ
    ç³»ç»Ÿ->>ç”¨æˆ·: å±•ç¤ºç­”æ¡ˆ
```

## æŠ€æœ¯å®ç°

### ç»„ä»¶æ¶æ„

- **MermaidDiagram**: ç‹¬ç«‹çš„ Mermaid æ¸²æŸ“ç»„ä»¶

  - ä½¿ç”¨ `mermaid` åº“è¿›è¡Œå›¾è¡¨æ¸²æŸ“
  - æ”¯æŒé”™è¯¯å¤„ç†å’Œè°ƒè¯•
  - è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ ID é¿å…å†²çª

- **MarkdownText**: æ‰©å±•çš„ Markdown æ¸²æŸ“å™¨
  - è‡ªåŠ¨æ£€æµ‹ `mermaid` ä»£ç å—
  - æ— ç¼é›†æˆ MermaidDiagram ç»„ä»¶
  - ä¿æŒä¸å…¶ä»– Markdown ç‰¹æ€§çš„å…¼å®¹æ€§

### é…ç½®è¯´æ˜

Mermaid åˆå§‹åŒ–é…ç½®ï¼ˆåœ¨ `mermaid-diagram.tsx` ä¸­ï¼‰ï¼š

```typescript
mermaid.initialize({
  startOnLoad: false, // æ‰‹åŠ¨æ§åˆ¶æ¸²æŸ“æ—¶æœº
  theme: "default", // é»˜è®¤ä¸»é¢˜
  securityLevel: "loose", // å…è®¸æ›´çµæ´»çš„æ¸²æŸ“
  fontFamily: "inherit", // ç»§æ‰¿é¡µé¢å­—ä½“
});
```

## æµ‹è¯•

åœ¨æµ‹è¯•é¡µé¢ä¸­æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹ï¼š

```
http://localhost:3000/test-components
```

é€‰æ‹© **ğŸ”· Mermaid å›¾è¡¨** æ ‡ç­¾é¡µï¼Œå¯ä»¥çœ‹åˆ°ï¼š

1. æµç¨‹å›¾ç¤ºä¾‹
2. åºåˆ—å›¾ç¤ºä¾‹
3. ç”˜ç‰¹å›¾ç¤ºä¾‹
4. é¥¼å›¾ç¤ºä¾‹
5. ç±»å›¾ç¤ºä¾‹
6. Markdown ä¸­çš„ Mermaid é›†æˆæµ‹è¯•

## å¸¸è§é—®é¢˜

### Q: Mermaid å›¾è¡¨ä¸æ˜¾ç¤ºï¼Ÿ

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. ç¡®ä¿ Mermaid ä»£ç è¯­æ³•æ­£ç¡®
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
3. ç¡®è®¤ `mermaid` ä¾èµ–å·²æ­£ç¡®å®‰è£…

### Q: å¦‚ä½•è‡ªå®šä¹‰å›¾è¡¨æ ·å¼ï¼Ÿ

A: å¯ä»¥åœ¨ `mermaid-diagram.tsx` ä¸­ä¿®æ”¹ `mermaid.initialize()` çš„é…ç½®ï¼Œæ”¯æŒçš„ä¸»é¢˜åŒ…æ‹¬ï¼š

- `default`
- `dark`
- `forest`
- `neutral`

### Q: å›¾è¡¨æ¸²æŸ“é”™è¯¯æ€ä¹ˆåŠï¼Ÿ

A: MermaidDiagram ç»„ä»¶ä¼šè‡ªåŠ¨æ•è·é”™è¯¯å¹¶æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š

- é”™è¯¯æ¶ˆæ¯
- åŸå§‹ Mermaid ä»£ç ï¼ˆå¯å±•å¼€æŸ¥çœ‹ï¼‰

## å‚è€ƒèµ„æº

- [Mermaid å®˜æ–¹æ–‡æ¡£](https://mermaid.js.org/)
- [Mermaid Live Editor](https://mermaid.live/) - åœ¨çº¿æµ‹è¯• Mermaid è¯­æ³•
- [Mermaid è¯­æ³•é€ŸæŸ¥è¡¨](https://mermaid.js.org/syntax/flowchart.html)

## æ›´æ–°æ—¥å¿—

### v1.1.1 (2025-10-15)

- âœ… **ä¿®å¤**: ä¿®å¤ Markdown ä¸­ Mermaid å›¾è¡¨èƒŒæ™¯æ˜¾ç¤ºé—®é¢˜
- âœ… **ä¼˜åŒ–**: ç§»é™¤æ¸²æŸ“å®¹å™¨çš„æ ·å¼å†²çªï¼Œç¡®ä¿é€æ˜èƒŒæ™¯åœ¨æ‰€æœ‰åœºæ™¯ä¸‹ç”Ÿæ•ˆ

### v1.1.0 (2025-10-15)

- âœ… **æ–°å¢**: é€æ˜èƒŒæ™¯æ”¯æŒï¼Œå›¾è¡¨è‡ªåŠ¨é€‚åº”é¡µé¢é¢œè‰²
- âœ… **æ–°å¢**: æºä»£ç æŸ¥çœ‹æŒ‰é’®ï¼Œå¯æŠ˜å å±•å¼€æŸ¥çœ‹ Mermaid æºä»£ç 
- âœ… **ä¼˜åŒ–**: ç®€åŒ–æµ‹è¯•é¡µé¢å¸ƒå±€ï¼Œç§»é™¤é‡å¤çš„ä»£ç å±•ç¤º

### v1.0.0 (2025-10-15)

- âœ… æ·»åŠ  Mermaid æ¸²æŸ“æ”¯æŒ
- âœ… é›†æˆåˆ° Markdown æ¸²æŸ“å™¨
- âœ… æ·»åŠ æµ‹è¯•é¡µé¢å’Œç¤ºä¾‹
- âœ… æ”¯æŒå¤šç§å›¾è¡¨ç±»å‹
- âœ… é”™è¯¯å¤„ç†å’Œå‹å¥½æç¤º
